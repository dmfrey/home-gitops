apiVersion: "tanzu.vmware.com/v1"
kind: SpringCloudGateway
metadata:
  name: spring-dev-gateway
  namespace: spring-dev
spec:

  count: 3

  env:
    - name: logging.level.org.springframework.web
      value: info
    - name: management.tracing.sampling.probability
      value: "1.0"
    - name: spring.cloud.gateway.metrics.enabled
      value: "true"
    - name: spring.sleuth.trace-id128
      value: "true"
    - name: spring.cloud.gateway.filter.strip-prefix.enabled
      value: "false"

  healthCheck:
    enabled: true

  sso:
    secret: spring-dev-gateway-secret

  observability:
    metrics:
      prometheus:
        enabled: true
        serviceMonitor:
          enabled: true

    tracing:
      zipkin:
        enabled: true
        url: http://otelcol-dm-opentelemetry-collector.monitor.svc.cluster.local:9411/api/v2/spans
